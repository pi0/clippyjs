<!doctype html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="./assets/clippy.css" media="all" />
    <style>
      html {
        background: url("http://wallpapercave.com/wp/7VNksl0.jpg") no-repeat center center fixed;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
      }
    </style>
  </head>
  <body style="width: 100%; height: 100vh">
    <script type="module">
      import { clippy } from "./src/index.ts";

      window.CLIPPY_CDN = "/assets/agents/";

      var availableAgents = [
        "Bonzi",
        "Clippy",
        "F1",
        "Genie",
        "Genius",
        "Links",
        "Merlin",
        "Peedy",
        "Rocky",
        "Rover",
      ];

      var talks = [
        "How can i help you?",
        "Nice day!",
        "Glad to meet you.",
        "At your service",
        "Helloo",
      ];

      const randPos = () => 0.2 + Math.random() * 0.6;

      function nextAgent() {
        let agentName = availableAgents.pop();
        if (!agentName) return;

        clippy.load(agentName, (agent) => {
          window[agentName] = agent;

          const move = () => {
            agent.moveTo(
              document.documentElement.clientWidth * randPos(),
              document.documentElement.clientHeight * randPos(),
            );
          };

          move();

          agent.show();

          // Speak on click and start
          const speak = () => {
            agent.speak("I am " + agentName + ", " + talks[~~(Math.random() * talks.length)]);
            agent.animate();
          };
          agent._el.addEventListener("click", () => speak());
          speak();

          // Animate randomly
          setInterval(
            () => {
              agent.animate();
            },
            3000 + Math.random() * 4000,
          );

          // Move randomly
          setInterval(
            () => {
              move();
            },
            3000 + Math.random() * 4000,
          );

          setTimeout(nextAgent, 2000);
        });
      }

      nextAgent();
    </script>
  </body>
</html>
